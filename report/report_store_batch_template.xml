<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>
    <template id="report_store_batch_template" t-name="store_product_batch.report_store_batch_template">
      <t t-call="web.html_container">
        <t t-call="web.internal_layout">
          <t class="mb-4">
          <h4 class="text-warning">Branch Chart</h4>

           <div id="my_chart" style="height:400px;"></div>
           <div id="chart_controls" class="mb-3">
            <button class="btn btn-outline-primary" data-dimension="Year">Year</button>
            <button class="btn btn-outline-success" data-dimension="Month">Month</button>
            <button class="btn btn-outline-warning" data-dimension="Week">Week</button>
          </div>

            <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
            <script>
              const chartDom = document.getElementById('my_chart');
              const chart = echarts.init(chartDom);

              function updateChart(timeDimension) {
                fetch('/store_product_batch/chart_data', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'X-Requested-With': 'XMLHttpRequest'
                  },
                  body: JSON.stringify({ time_dimension: timeDimension })
                })
                .then(response => response.json())
                .then(option => {
                  chart.setOption(option);
                })
                .catch(error => {
                  console.error('Failed to load chart data:', error);
                });
              }

              document.addEventListener("DOMContentLoaded", function () {
                updateChart('Year');  // Initial render

                const selector = document.getElementById('time_selector');
                if (selector) {
                  selector.addEventListener('change', function (e) {
                    updateChart(e.target.value);
                  });
                }

                const buttons = document.querySelectorAll('#chart_controls button');
                buttons.forEach(btn => {
                  btn.addEventListener('click', function () {
                    const dimension = btn.getAttribute('data-dimension');
                    updateChart(dimension);
                  });
                });
              });

            </script>


        </t>

        
        </t>
      </t>
    </template>
 </data>
  
</odoo>
